<!DOCTYPE html>
<html lang="ky">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>CAPIFAN ‚Äî —Ç–∞–±–∏—è—Ç—Ç–∞–Ω —Å–∏–∑–¥–∏–Ω –¥–∞—Å—Ç–æ—Ä–∫–æ–Ω—É“£—É–∑–≥–∞</title>
  <meta name="theme-color" content="#d86916"/>
  <link rel="manifest" href="manifest.json?v=2">

  <!-- iOS / iPadOS app icon -->
  <link rel="apple-touch-icon" sizes="120x120" href="icons/ios-120x120.png?v=2">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/ios-180x180.png?v=2">
  <link rel="apple-touch-icon" sizes="1024x1024" href="icons/ios-1024x1024.png?v=2">

  <!-- PWA meta -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  
  <!-- üé® Estilos generales -->
  <style>
    :root{--mango:#f3a21b;--honey:#d86916;--ink:#1e293b;--muted:#64748b;--card:#fff;--bg:#fff7ec}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial;color:var(--ink);background:linear-gradient(180deg,#fff,var(--bg))}
    .topbar{position:sticky;top:0;z-index:5;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 16px;background:rgba(255,255,255,.88);backdrop-filter:saturate(1.2) blur(6px);border-bottom:1px solid #ffe1ad}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:42px;height:42px;border-radius:12px;background:radial-gradient(100% 100% at 30% 30%, var(--mango), var(--honey));box-shadow:0 6px 20px rgba(216,105,22,.25)}
    .brand-name{font-weight:800} .slogan{font-size:12px;color:var(--muted)}
    .controls{display:flex;align-items:center;gap:8px}
    select,.btn{border:1px solid #ffd489;background:#fff;color:var(--ink);padding:8px 10px;border-radius:12px;font:inherit}
    .btn.mango{background:linear-gradient(180deg,#fff8eb,#ffe3b3);font-weight:700;cursor:pointer}
    .shell{max-width:1100px;margin:0 auto;padding:16px}
    .notice{margin:10px 16px;padding:10px 12px;border:1px dashed #ffd08a;border-radius:12px;background:#fff7e8;color:#6a3c13;font-weight:600}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
    .card{background:var(--card);border:1px solid #ffe1ad;border-radius:18px;padding:14px;box-shadow:0 6px 16px rgba(243,162,27,.08);display:flex;flex-direction:column;gap:10px}
    .card img{width:100%;height:160px;object-fit:cover;border-radius:12px;border:1px solid #ffe1ad}
    .qty{display:flex;align-items:center;gap:8px}.qty .q{min-width:22px;text-align:center;display:inline-block}

    /* ===== Carrito (popup en m√≥viles) ===== */
    .popup{position:fixed; inset:0; z-index:1000; display:block; pointer-events:none;}
    .popup.open{ pointer-events:auto; }
    .backdrop{position:absolute; inset:0; background:rgba(0,0,0,.35); opacity:0; transition:opacity .2s ease;}
    .popup.open .backdrop{ opacity:1; }
    .panel{position:fixed; left:0; right:0; bottom:0; top: calc(env(safe-area-inset-top, 0px) + 64px); background:#fff; border-top-left-radius:18px; border-top-right-radius:18px; box-shadow:0 -10px 30px rgba(0,0,0,.15); transform: translateY(100%); transition: transform .25s ease; display:flex; flex-direction:column; padding:calc(12px + env(safe-area-inset-top, 0px)) 16px calc(14px + env(safe-area-inset-bottom, 0px)); overflow:hidden;}
    .popup.open .panel{ transform: translateY(0); }
    .panel #cartItems{ flex:1; overflow:auto; -webkit-overflow-scrolling:touch; }
    body.no-scroll{ overflow:hidden; height:100dvh; }
    .badge{background:#dc2626;color:#fff;border-radius:999px;min-width:18px;padding:2px 6px;font-size:12px}
    .foot{color:var(--muted);text-align:center;padding:16px}

    /* Bot√≥n eliminar */
    .btn-remove{background:linear-gradient(180deg,rgba(255,0,0,0.12),rgba(255,0,0,0.18));border:1px solid rgba(255,0,0,0.25);color:#000;font-weight:600;cursor:pointer;transition:transform 0.05s ease,background 0.2s ease;border-radius:12px;padding:8px 10px;}
    .btn-remove:hover{background:linear-gradient(180deg,rgba(255,0,0,0.18),rgba(255,0,0,0.25));}
    .btn-remove:active{transform:scale(0.97);}
     
    /* Bot√≥n cerrar carrito */
    #closeCart{background:linear-gradient(180deg,#d1f7d1,#a6e3a6);border:1px solid #6ccf6c;color:#000;font-weight:700;cursor:pointer;border-radius:12px;padding:8px 10px;}
    #closeCart:hover{background:linear-gradient(180deg,#a6e3a6,#8cd88c);}
  </style>

  <!-- üñºÔ∏è OVERRIDE im√°genes -->
  <style id="imgfix-override">
    #product-list .product img,
    .product img,
    img.product-image {
      height: 320px !important;
      width: 100% !important;
      object-fit: contain !important;
      display: block !important;
      margin: 0 auto 10px !important;
      border-radius: 12px !important;
      border: 1px solid #ffe1ad !important;
    }
  </style>

  <!-- ‚úÖ Bot√≥n Confirmar Pedido -->
  <style id="confirm-btn-final">
    aside #confirm {
      -webkit-appearance: none;
      appearance: none;
      width: auto;
      padding: 10px 14px;
      font-size: 1em;
      border-radius: 6px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.25s ease;
    }
    aside #confirm:disabled {
      background: #f0f0f0 !important;
      color: #000 !important;
      border: 1px solid #ccc !important;
      cursor: not-allowed !important;
      box-shadow: none !important;
    }
    aside #confirm:not(:disabled) {
      background: linear-gradient(180deg, #fcd34d, #f59e0b) !important;
      color: #000 !important;
      border: 1px solid #d97706 !important;
      box-shadow: 0 0 8px rgba(245, 158, 11, 0.4),
                  0 4px 10px rgba(0, 0, 0, 0.15) !important;
    }
    aside #confirm:not(:disabled):hover {
      background: linear-gradient(180deg, #fde68a, #f59e0b) !important;
      box-shadow: 0 0 12px rgba(245, 158, 11, 0.6),
                  0 6px 14px rgba(0,0,0,0.2) !important;
      transform: scale(1.02);
    }
    aside #confirm:not(:disabled):active {
      transform: scale(0.98);
      box-shadow: 0 0 6px rgba(245, 158, 11, 0.3),
                  0 3px 6px rgba(0,0,0,0.2) !important;
    }
    @media (max-width: 600px){
      aside #confirm {
        width: auto !important;
        flex: 0 0 auto !important;
        display: inline-flex !important;
        align-self: flex-start;
      }
    }
  </style>

  <!-- üåç intl-tel-input (banderas y prefijos internacionales) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
</head>
<body>
  <!-- ‚Ä¶ tu body, productos y carrito igual que lo tienes ‚Ä¶ -->

<script>
/* ‚Ä¶ tu c√≥digo previo ‚Ä¶ */

function confirmOrder(){
  if(cart.length===0){ 
    alert(T.empty_cart[lang] + " ‚Äî TOTAL: $0 / 0 —Å–æ–º"); 
    return; 
  }

  const name  = document.getElementById("custName").value.trim();
  // ‚úÖ usar intl-tel-input
  const phone = iti.getNumber(); 
  const email = document.getElementById("custEmail").value.trim();
  const err   = document.getElementById("formError");

  if (!name || !phone || !email) {
    if (err) {
      err.textContent = "üêù " + T.fill_required[lang];
      err.style.display = "block";
    }
    return;
  } else {
    if (err) err.style.display = "none";
  }

  /* ‚Ä¶ resto de confirmOrder igual ‚Ä¶ */
}

/* ================== INIT ================== */
if ('serviceWorker' in navigator) { navigator.serviceWorker.getRegistrations().then(rs=>rs.forEach(r=>r.unregister())); }
window.addEventListener("load", () => {
  try{
    /* ‚Ä¶ tu init ‚Ä¶ */

    // ‚úÖ Inicializar intl-tel-input
    window.iti = window.intlTelInput(document.querySelector("#custPhone"), {
      initialCountry: "kg",
      preferredCountries: ["kg","es","us","ru"],
      separateDialCode: true
    });

    /* ‚Ä¶ validaci√≥n de campos ‚Ä¶ */
  }catch(e){ console.error("Init error", e); }
});
</script>
</body>
</html>
